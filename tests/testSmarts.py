from rdkit import Chem

from config import SMARTS_N_HOPS_FROM_ATTACHMENT
from molPlot import plotMols
from reactionSmarts import runReactionInAttachment



def _test_runReactionInAttachment():
    modifiedMol = b'\xef\xbe\xad\xde\x00\x00\x00\x00\x0c\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00"\x00\x00\x00%\x00\x00\x00\x80\x01\x06\x00`\x00\x00\x00\x01\x03\x06\x00`\x00\x00\x00\x03\x01\x08\x00 \x00\x00\x00\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x03\x01\x06\x00(\x00\x00\x00\x03\x04\x08\x00(\x00\x00\x00\x03\x02\x07\x00h\x00\x00\x00\x03\x02\x01\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06@(\x00\x00\x00\x03\x04\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@(\x00\x00\x00\x03\x04\x07\x00h\x00\x00\x00\x03\x02\x01\x06\x00`\x00\x00\x00\x03\x01\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x03\x01\x06\x00(\x00\x00\x00\x03\x04\x08\x00(\x00\x00\x00\x03\x02\x07\x00h\x00\x00\x00\x03\x02\x01\x06\x00`\x00\x00\x00\x02\x02\x06@(\x00\x00\x00\x03\x04\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x07@(\x00\x00\x00\x03\x03\x06\x00`\x00\x00\x00\x01\x03\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06@h\x00\x00\x00\x03\x03\x01\x0b\x00\x01\x00\x01\x02\x00\x02\x03\x00\x03\x04\x00\x04\x05\x00\x05\x06\x00\x06\x07(\x02\x06\x08 \x08\t\x00\t\n\x00\n\x0b\x00\x0b\x0ch\x0c\x0c\rh\x0c\r\x0eh\x0c\x0e\x0fh\x0c\x0f\x10 \x10\x11\x00\x11\x12\x00\x12\x13\x00\x13\x14\x00\x14\x15\x00\x15\x16(\x02\x15\x17 \x17\x18\x00\x18\x19\x00\x19\x1ah\x0c\x1a\x1bh\x0c\x1b\x1ch\x0c\x1c\x1dh\x0c\x1d\x1e\x00\x14\x1f\x00\x1f \x00\x0f!h\x0c\x05\x01\x00!\x0bh\x0c \x11\x00\x1d\x19h\x0c\x14\x04\x05\x01\x02\x03\x04\x05\x06\x0c\r\x0e\x0f!\x0b\x06\x12\x13\x14\x1f \x11\x05\x1a\x19\x1d\x1c\x1b\x17\x01\x00\x00\x00\x01\x00\x00\x00\x00"\xb6\x0f\xe3@\xf3\xff:\xc0O\xf8\x9f?\x91k\xe3@\xfbv\xce\xbf\xb4`\x08?\xf5\\\xfe@A\xb0\xca\xbf\xc3\xf0\x0f\xbf\x80\x1d\xea@\xe8\xfa\r\xc0>\xfb\xcd\xbf\xbe\xa6\xba@\xdf\x03\x08\xc0\x812\xb0\xbf\x12\x88\xb8@\xb1#\xa4\xbfN\xc8\xc4\xbd\x9d\x18\xb9@\x89E!>\x9b\xd4\xfc\xbe\xdfw\xd9@;t`?\xd8\xe6\x95\xbe\xf3\x1c\x95@quD?\xb5\x84\x8e\xbf\xf0\x11\x97@z\x96\x0b@eI\xbe\xbf\xaf\x05]@!c)@\xba\xd6\x07\xc0\x86\x01\x13@;[\x1f@\xbaf\x9b\xbf%\xc7\xfd?Ipb@n\xc4\xc4\xbe\xda\xb9g?3QY@-\x1e\xed>\xa0K\x1f>x{\x0f@\xd0c\xfa>Fa\xf2>\x16\x15\x99?\x1a_\xaf\xbe\xe0\xaa\x8a\xbe\x06^\xc7\xbc\x80@\xb7\xbe\x9c\x1c\xb5\xbf|\x8d\x80\xbe\x1a\xcb\xfc>\x18h\x83\xbfy\xc6\x15\xbe\xd2\x06\xfc?\xe7Z\x0f\xc0\xe1\x06\x94\xbd\xc236@\xf0\x91H\xc0\xbb\x06\x89?#\xd6\x1f@;\xce\x90\xc0\xfe\x1c+?&\xa4\x0b@2\x8f\xae\xc0\xa5\x1f\x91?D\xd78@\xa5\xa8\x9b\xc0m\x06X\xbeft\x90?\x7f@\xc7\xc0\xd5F\x19\xbfYuS?\xb1\xd6\xc5\xc0\x07\x96\xc4\xbfw\x04\xb3\xbe@\xdf\xa2\xc0<~\xfe\xbf\x83\x92\x83\xbfl\xfb\xb0\xc0;\xc14\xc0\xaa\xaf\x01\xc0\x9b\x85\xdc\xc0\xfa17\xc0\xb7m\xf7\xbf{\\\xe8\xc0\xdb\x1c\x05\xc0\x99\xd9j\xbf-l\n\xc1j\x02\xef\xbft\x10\x02\xbf\x19.%\xc0\xb3h\xe1?\x0b\x80\xa2?\x99\xe5\x1f\xc0.y:?\xa9g*>\x0c6\xc6?!-\xad?\xa4\x11\x97\xbf\x16'
    modifiedMol = Chem.Mol(modifiedMol)
    reactant1 = b'\xef\xbe\xad\xde\x00\x00\x00\x00\x0c\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x15\x00\x00\x00\x80\x01\x06\x00`\x00\x00\x00\x01\x03\x06\x00`\x00\x00\x00\x03\x01\x08\x00 \x00\x00\x00\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x03\x01\x06\x00(\x00\x00\x00\x03\x04\x08\x00(\x00\x00\x00\x03\x02\x07\x00h\x00\x00\x00\x03\x02\x01\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06@(\x00\x00\x00\x03\x04\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@(\x00\x00\x00\x03\x04\x06\x00(\x00\x00\x00\x03\x04\x08\x00(\x00\x00\x00\x03\x02\x08\x00h\x00\x00\x00\x03\x01\x01\x0b\x00\x01\x00\x01\x02\x00\x02\x03\x00\x03\x04\x00\x04\x05\x00\x05\x06\x00\x06\x07(\x02\x06\x08 \x08\t\x00\t\n\x00\n\x0b\x00\x0b\x0ch\x0c\x0c\rh\x0c\r\x0eh\x0c\x0e\x0fh\x0c\x0f\x10h\x0c\x10\x11 \x11\x12(\x02\x11\x13 \x05\x01\x00\x10\x0bh\x0c\x14\x02\x05\x01\x02\x03\x04\x05\x06\x0c\r\x0e\x0f\x10\x0b\x17\x01\x00\x00\x00\x01\x00\x00\x00\x00\x14h)\xe2@"_;\xc0U#\xa4?\x9f\xa3\xe3@\xb8\xe9\xce\xbf4\x17\x03?\xbc\x83\x00AW\x1f\xda\xbfoW\x0b\xbf\xe8%\xea@)o\x0e\xc0=\x1e\xd2\xbf\xb7\x92\xba@\xb6\xfd\x04\xc0\x0c\x8d\xb0\xbf8\xf7\xb8@\xd6\x80\xa2\xbfp|\xe5\xbd\x90C\xb9@0DF>\x9a\xaf\xf4\xbeW\x0c\xda@\xc3qf?\x84\x93\x86\xbe\x96U\x95@\x02\xf0I?\xdd\xe7\x8e\xbf\x8c9\x97@E\xbf\x0c@\xe0,\xbd\xbfw\xd9\\@\xebS)@\xbc1\n\xc0\xe9\x16\x12@\xc9\xf8\x1e@\xd6\x0f\xa0\xbf\xc0\x7f\xfc?\xe0Mb@Y\xf8\xc4\xbe\xf0Gf?\xbd\x0b[@kM\xfe>\xfb\x00\x0f>,M\x10@c\x0c\x07?\xb3\xbb\xe5>N\x80\x99?\xcb\xb3\xa6\xbe\xed\x98\xc1?\x9e\xfd\xa5?\x02\xeb\x9c\xbf\x13\x15\xde?d\xe5\x18>\xd7\xf9\x08\xc0\xa6\xae\x1e@\xbc1\x80>q\xa7I\xc08a\x8b?B\x90\x87\xbf\x1e\xac\xf3\xbf\x16'
    reactant2 = b'\xef\xbe\xad\xde\x00\x00\x00\x00\x0c\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x12\x00\x00\x00\x13\x00\x00\x00\x80\x01\x06\x00`\x00\x00\x00\x01\x03\x07@(\x00\x00\x00\x03\x03\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@h\x00\x00\x00\x03\x03\x01\x06@(\x00\x00\x00\x03\x04\x06\x00`\x00\x00\x00\x02\x02\x07\x00h\x00\x00\x00\x03\x02\x01\x06\x00(\x00\x00\x00\x03\x04\x08\x00(\x00\x00\x00\x03\x02\x06 4\x00\x00\x00\x01\x01\x04\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x06 4\x00\x00\x00\x02\x01\x04\x06\x00`\x00\x00\x00\x02\x02\x07\x00`\x00\x00\x00\x01\x02\x06\x00`\x00\x00\x00\x02\x02\x06\x00`\x00\x00\x00\x02\x02\x0b\x00\x01\x00\x01\x02h\x0c\x02\x03h\x0c\x03\x04h\x0c\x04\x05h\x0c\x05\x06\x00\x06\x07\x00\x07\x08 \x08\t(\x02\x08\n\x00\n\x0b\x00\x0b\x0c\x00\x0c\r\x00\r\x0e\x00\x0e\x0f\x00\r\x10\x00\x10\x11\x00\x05\x01h\x0c\x11\n\x00\x14\x02\x05\x01\x02\x03\x04\x05\x06\x0b\x0c\r\x10\x11\n\x17\x01\x00\x00\x00\x01\x00\x00\x00\x00\x121\xa5\n\xc1\x7f\xde\xee\xbf\xbe1\x01\xbf_G\xe9\xc0\xb2?\x05\xc0\xed\x9fj\xbf\x08\xe8\xdc\xc0`P7\xc0\xe1\xb9\xf7\xbf\x10\xc2\xb0\xc0\x85\xff4\xc0\xce\x1e\x02\xc0\x19!\xa2\xc0ip\xfe\xbf\x92\xb5\x83\xbf\x142\xc6\xc0`"\xc6\xbf\xad\xb3\xb8\xbe%\xe6\xc6\xc0\xdc\x94\x1d\xbf\xa3\x02P?\xf9\x83\x9b\xc0`\xb0p\xbe\x98=\x95?\xa6\xbf\x91\xc0\xb8\xd7*?\x8c\x93\x0e@\xbcC\xaf\xc0+\xfe\x92?\xff\xaf;@\x89\'I\xc0\xfey\x8c?\xa6\x07\x1e@\x9f\x82\x10\xc0Q{\xc7\xbd\xaa\xf66@\x9a\xd8\x80\xbfd{V\xbe\xf4\x1a\xfe?\xb1\xf0\xb1\xbf1O\x8e\xbe\x0e\xf2\x00?~\xd9\x0b\xbe\xe0\xcc1\xbe\xc2\x06\xb1\xbe,\xe5\xd7\xbe0!\x17\xbf[\x9e\xda\xbfM\x98\x19\xc0E\x16N?\x0c\x06\xd3={\x07(\xc0<\xbf\xe8?o\xe6\x9c?\x16'
    reactant1 = Chem.Mol(reactant1)
    reactant2 = Chem.Mol(reactant2)
    reactionName = 'Reductive_amination'
    attachmentIdxs = [14, 15, 16]
    prodsList = runReactionInAttachment(reactant1, reactant2, reactionName, refMol = modifiedMol,
                                        ref_attachmentIdxs=attachmentIdxs,
                                        n_hops_from_attachment=SMARTS_N_HOPS_FROM_ATTACHMENT)

    plotMols(prodsList+[reactant1, reactant2])
    print("end")

_test_runReactionInAttachment()